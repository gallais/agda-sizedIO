<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
><head
  ><title
    >IO.Primitive</title
    ><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"
     /><meta http-equiv="Content-Style-Type" content="text/css"
     /><link href="Agda.css" rel="stylesheet" type="text/css"
     /></head
  ><body
  ><pre
    ><a name="1" class="Comment"
      >------------------------------------------------------------------------</a
      >
<a name="74" class="Comment"
      >-- The Agda standard library</a
      >
<a name="103" class="Comment"
      >--</a
      >
<a name="106" class="Comment"
      >-- Primitive IO: simple bindings to Haskell types and functions</a
      >
<a name="170" class="Comment"
      >------------------------------------------------------------------------</a
      >

<a name="244" class="Keyword"
      >module</a
      > <a name="251" href="IO.Primitive.html" class="Module"
      >IO.Primitive</a
      > <a name="264" class="Keyword"
      >where</a
      >

<a name="271" class="Keyword"
      >open</a
      > <a name="276" class="Keyword"
      >import</a
      > <a name="283" href="Data.Char.Base.html" class="Module"
      >Data.Char.Base</a
      >
<a name="298" class="Keyword"
      >open</a
      > <a name="303" class="Keyword"
      >import</a
      > <a name="310" href="Data.String.html" class="Module"
      >Data.String</a
      >
<a name="322" class="Keyword"
      >open</a
      > <a name="327" class="Keyword"
      >import</a
      > <a name="334" href="Foreign.Haskell.html" class="Module"
      >Foreign.Haskell</a
      >

<a name="351" class="Comment"
      >------------------------------------------------------------------------</a
      >
<a name="424" class="Comment"
      >-- The IO monad</a
      >

<a name="441" class="Keyword"
      >open</a
      > <a name="446" class="Keyword"
      >import</a
      > <a name="453" href="Agda.Builtin.IO.html" class="Module"
      >Agda.Builtin.IO</a
      > <a name="469" class="Keyword"
      >public</a
      > <a name="476" class="Keyword"
      >using</a
      > <a name="482" class="Symbol"
      >(</a
      ><a name="483" href="Agda.Builtin.IO.html#IO" class="Postulate"
      >IO</a
      ><a name="485" class="Symbol"
      >)</a
      >

<a name="488" class="Keyword"
      >infixl</a
      > <a name="495" class="Number"
      >1</a
      > <a name="497" href="IO.Primitive.html#_&gt;&gt;=_" class="Postulate Operator"
      >_&gt;&gt;=_</a
      >

<a name="504" class="Keyword"
      >postulate</a
      >
  <a name="return" href="IO.Primitive.html#return" class="Postulate"
      >return</a
      > <a name="523" class="Symbol"
      >:</a
      > <a name="525" class="Symbol"
      >&#8704;</a
      > <a name="527" class="Symbol"
      >{</a
      ><a name="528" href="IO.Primitive.html#528" class="Bound"
      >a</a
      ><a name="529" class="Symbol"
      >}</a
      > <a name="531" class="Symbol"
      >{</a
      ><a name="532" href="IO.Primitive.html#532" class="Bound"
      >A</a
      > <a name="534" class="Symbol"
      >:</a
      > <a name="536" class="PrimitiveType"
      >Set</a
      > <a name="540" href="IO.Primitive.html#528" class="Bound"
      >a</a
      ><a name="541" class="Symbol"
      >}</a
      > <a name="543" class="Symbol"
      >&#8594;</a
      > <a name="545" href="IO.Primitive.html#532" class="Bound"
      >A</a
      > <a name="547" class="Symbol"
      >&#8594;</a
      > <a name="549" href="Agda.Builtin.IO.html#IO" class="Postulate"
      >IO</a
      > <a name="552" href="IO.Primitive.html#532" class="Bound"
      >A</a
      >
  <a name="_&gt;&gt;=_" href="IO.Primitive.html#_&gt;&gt;=_" class="Postulate Operator"
      >_&gt;&gt;=_</a
      >  <a name="563" class="Symbol"
      >:</a
      > <a name="565" class="Symbol"
      >&#8704;</a
      > <a name="567" class="Symbol"
      >{</a
      ><a name="568" href="IO.Primitive.html#568" class="Bound"
      >a</a
      > <a name="570" href="IO.Primitive.html#570" class="Bound"
      >b</a
      ><a name="571" class="Symbol"
      >}</a
      > <a name="573" class="Symbol"
      >{</a
      ><a name="574" href="IO.Primitive.html#574" class="Bound"
      >A</a
      > <a name="576" class="Symbol"
      >:</a
      > <a name="578" class="PrimitiveType"
      >Set</a
      > <a name="582" href="IO.Primitive.html#568" class="Bound"
      >a</a
      ><a name="583" class="Symbol"
      >}</a
      > <a name="585" class="Symbol"
      >{</a
      ><a name="586" href="IO.Primitive.html#586" class="Bound"
      >B</a
      > <a name="588" class="Symbol"
      >:</a
      > <a name="590" class="PrimitiveType"
      >Set</a
      > <a name="594" href="IO.Primitive.html#570" class="Bound"
      >b</a
      ><a name="595" class="Symbol"
      >}</a
      > <a name="597" class="Symbol"
      >&#8594;</a
      > <a name="599" href="Agda.Builtin.IO.html#IO" class="Postulate"
      >IO</a
      > <a name="602" href="IO.Primitive.html#574" class="Bound"
      >A</a
      > <a name="604" class="Symbol"
      >&#8594;</a
      > <a name="606" class="Symbol"
      >(</a
      ><a name="607" href="IO.Primitive.html#574" class="Bound"
      >A</a
      > <a name="609" class="Symbol"
      >&#8594;</a
      > <a name="611" href="Agda.Builtin.IO.html#IO" class="Postulate"
      >IO</a
      > <a name="614" href="IO.Primitive.html#586" class="Bound"
      >B</a
      ><a name="615" class="Symbol"
      >)</a
      > <a name="617" class="Symbol"
      >&#8594;</a
      > <a name="619" href="Agda.Builtin.IO.html#IO" class="Postulate"
      >IO</a
      > <a name="622" href="IO.Primitive.html#586" class="Bound"
      >B</a
      >

<a name="625" class="Symbol"
      >{-#</a
      > <a name="629" class="Keyword"
      >COMPILE</a
      > GHC <a name="641" href="IO.Primitive.html#return" class="Postulate"
      >return</a
      > = \_ _ -&gt; return    <a name="668" class="Symbol"
      >#-}</a
      >
<a name="672" class="Symbol"
      >{-#</a
      > <a name="676" class="Keyword"
      >COMPILE</a
      > GHC <a name="688" href="IO.Primitive.html#_&gt;&gt;=_" class="Postulate Operator"
      >_&gt;&gt;=_</a
      >  = \_ _ _ _ -&gt; (&gt;&gt;=) <a name="715" class="Symbol"
      >#-}</a
      >
<a name="719" class="Symbol"
      >{-#</a
      > <a name="723" class="Keyword"
      >COMPILE</a
      > UHC <a name="735" href="IO.Primitive.html#return" class="Postulate"
      >return</a
      > = \_ _ x -&gt; UHC.Agda.Builtins.primReturn x <a name="785" class="Symbol"
      >#-}</a
      >
<a name="789" class="Symbol"
      >{-#</a
      > <a name="793" class="Keyword"
      >COMPILE</a
      > UHC <a name="805" href="IO.Primitive.html#_&gt;&gt;=_" class="Postulate Operator"
      >_&gt;&gt;=_</a
      >  = \_ _ _ _ x y -&gt; UHC.Agda.Builtins.primBind x y <a name="861" class="Symbol"
      >#-}</a
      >

<a name="866" class="Comment"
      >------------------------------------------------------------------------</a
      >
<a name="939" class="Comment"
      >-- Simple lazy IO</a
      >

<a name="958" class="Comment"
      >-- Note that the functions below produce commands which, when</a
      >
<a name="1020" class="Comment"
      >-- executed, may raise exceptions.</a
      >

<a name="1056" class="Comment"
      >-- Note also that the semantics of these functions depends on the</a
      >
<a name="1122" class="Comment"
      >-- version of the Haskell base library. If the version is 4.2.0.0 (or</a
      >
<a name="1192" class="Comment"
      >-- later?), then the functions use the character encoding specified by</a
      >
<a name="1263" class="Comment"
      >-- the locale. For older versions of the library (going back to at</a
      >
<a name="1330" class="Comment"
      >-- least version 3) the functions use ISO-8859-1.</a
      >

<a name="1381" class="Symbol"
      >{-#</a
      > <a name="1385" class="Keyword"
      >FOREIGN</a
      > GHC import qualified Data.Text    <a name="1427" class="Symbol"
      >#-}</a
      >
<a name="1431" class="Symbol"
      >{-#</a
      > <a name="1435" class="Keyword"
      >FOREIGN</a
      > GHC import qualified Data.Text.IO <a name="1477" class="Symbol"
      >#-}</a
      >
<a name="1481" class="Symbol"
      >{-#</a
      > <a name="1485" class="Keyword"
      >FOREIGN</a
      > GHC import qualified System.IO    <a name="1527" class="Symbol"
      >#-}</a
      >
<a name="1531" class="Symbol"
      >{-#</a
      > <a name="1535" class="Keyword"
      >FOREIGN</a
      > GHC import qualified Control.Exception <a name="1582" class="Symbol"
      >#-}</a
      >

<a name="1587" class="Keyword"
      >postulate</a
      >
  <a name="getContents" href="IO.Primitive.html#getContents" class="Postulate"
      >getContents</a
      > <a name="1611" class="Symbol"
      >:</a
      > <a name="1613" href="Agda.Builtin.IO.html#IO" class="Postulate"
      >IO</a
      > <a name="1616" href="Data.String.html#Costring" class="Function"
      >Costring</a
      >
  <a name="readFile" href="IO.Primitive.html#readFile" class="Postulate"
      >readFile</a
      >    <a name="1639" class="Symbol"
      >:</a
      > <a name="1641" href="Agda.Builtin.String.html#String" class="Postulate"
      >String</a
      > <a name="1648" class="Symbol"
      >&#8594;</a
      > <a name="1650" href="Agda.Builtin.IO.html#IO" class="Postulate"
      >IO</a
      > <a name="1653" href="Data.String.html#Costring" class="Function"
      >Costring</a
      >
  <a name="writeFile" href="IO.Primitive.html#writeFile" class="Postulate"
      >writeFile</a
      >   <a name="1676" class="Symbol"
      >:</a
      > <a name="1678" href="Agda.Builtin.String.html#String" class="Postulate"
      >String</a
      > <a name="1685" class="Symbol"
      >&#8594;</a
      > <a name="1687" href="Data.String.html#Costring" class="Function"
      >Costring</a
      > <a name="1696" class="Symbol"
      >&#8594;</a
      > <a name="1698" href="Agda.Builtin.IO.html#IO" class="Postulate"
      >IO</a
      > <a name="1701" href="Foreign.Haskell.html#Unit" class="Datatype"
      >Unit</a
      >
  <a name="appendFile" href="IO.Primitive.html#appendFile" class="Postulate"
      >appendFile</a
      >  <a name="1720" class="Symbol"
      >:</a
      > <a name="1722" href="Agda.Builtin.String.html#String" class="Postulate"
      >String</a
      > <a name="1729" class="Symbol"
      >&#8594;</a
      > <a name="1731" href="Data.String.html#Costring" class="Function"
      >Costring</a
      > <a name="1740" class="Symbol"
      >&#8594;</a
      > <a name="1742" href="Agda.Builtin.IO.html#IO" class="Postulate"
      >IO</a
      > <a name="1745" href="Foreign.Haskell.html#Unit" class="Datatype"
      >Unit</a
      >
  <a name="putStr" href="IO.Primitive.html#putStr" class="Postulate"
      >putStr</a
      >      <a name="1764" class="Symbol"
      >:</a
      > <a name="1766" href="Data.String.html#Costring" class="Function"
      >Costring</a
      > <a name="1775" class="Symbol"
      >&#8594;</a
      > <a name="1777" href="Agda.Builtin.IO.html#IO" class="Postulate"
      >IO</a
      > <a name="1780" href="Foreign.Haskell.html#Unit" class="Datatype"
      >Unit</a
      >
  <a name="putStrLn" href="IO.Primitive.html#putStrLn" class="Postulate"
      >putStrLn</a
      >    <a name="1799" class="Symbol"
      >:</a
      > <a name="1801" href="Data.String.html#Costring" class="Function"
      >Costring</a
      > <a name="1810" class="Symbol"
      >&#8594;</a
      > <a name="1812" href="Agda.Builtin.IO.html#IO" class="Postulate"
      >IO</a
      > <a name="1815" href="Foreign.Haskell.html#Unit" class="Datatype"
      >Unit</a
      >

  <a name="1823" class="Comment"
      >-- Reads a finite file. Raises an exception if the file path refers</a
      >
  <a name="1893" class="Comment"
      >-- to a non-physical file (like &quot;/dev/zero&quot;).</a
      >

  <a name="readFiniteFile" href="IO.Primitive.html#readFiniteFile" class="Postulate"
      >readFiniteFile</a
      > <a name="1957" class="Symbol"
      >:</a
      > <a name="1959" href="Agda.Builtin.String.html#String" class="Postulate"
      >String</a
      > <a name="1966" class="Symbol"
      >&#8594;</a
      > <a name="1968" href="Agda.Builtin.IO.html#IO" class="Postulate"
      >IO</a
      > <a name="1971" href="Agda.Builtin.String.html#String" class="Postulate"
      >String</a
      >

<a name="1979" class="Symbol"
      >{-#</a
      > <a name="1983" class="Keyword"
      >FOREIGN</a
      > GHC
  readFiniteFile :: Data.Text.Text -&gt; IO Data.Text.Text
  readFiniteFile f = do
    h &lt;- System.IO.openFile (Data.Text.unpack f) System.IO.ReadMode
    Control.Exception.bracketOnError (return ()) (\_ -&gt; System.IO.hClose h)
                                                 (\_ -&gt; System.IO.hFileSize h)
    Data.Text.IO.hGetContents h
<a name="2330" class="Symbol"
      >#-}</a
      >

<a name="2335" class="Symbol"
      >{-#</a
      > <a name="2339" class="Keyword"
      >COMPILE</a
      > GHC <a name="2351" href="IO.Primitive.html#getContents" class="Postulate"
      >getContents</a
      >    = getContents                           <a name="2406" class="Symbol"
      >#-}</a
      >
<a name="2410" class="Symbol"
      >{-#</a
      > <a name="2414" class="Keyword"
      >COMPILE</a
      > GHC <a name="2426" href="IO.Primitive.html#readFile" class="Postulate"
      >readFile</a
      >       = readFile . Data.Text.unpack           <a name="2481" class="Symbol"
      >#-}</a
      >
<a name="2485" class="Symbol"
      >{-#</a
      > <a name="2489" class="Keyword"
      >COMPILE</a
      > GHC <a name="2501" href="IO.Primitive.html#writeFile" class="Postulate"
      >writeFile</a
      >      = \x -&gt; writeFile (Data.Text.unpack x)  <a name="2556" class="Symbol"
      >#-}</a
      >
<a name="2560" class="Symbol"
      >{-#</a
      > <a name="2564" class="Keyword"
      >COMPILE</a
      > GHC <a name="2576" href="IO.Primitive.html#appendFile" class="Postulate"
      >appendFile</a
      >     = \x -&gt; appendFile (Data.Text.unpack x) <a name="2631" class="Symbol"
      >#-}</a
      >
<a name="2635" class="Symbol"
      >{-#</a
      > <a name="2639" class="Keyword"
      >COMPILE</a
      > GHC <a name="2651" href="IO.Primitive.html#putStr" class="Postulate"
      >putStr</a
      >         = putStr                                <a name="2706" class="Symbol"
      >#-}</a
      >
<a name="2710" class="Symbol"
      >{-#</a
      > <a name="2714" class="Keyword"
      >COMPILE</a
      > GHC <a name="2726" href="IO.Primitive.html#putStrLn" class="Postulate"
      >putStrLn</a
      >       = putStrLn                              <a name="2781" class="Symbol"
      >#-}</a
      >
<a name="2785" class="Symbol"
      >{-#</a
      > <a name="2789" class="Keyword"
      >COMPILE</a
      > GHC <a name="2801" href="IO.Primitive.html#readFiniteFile" class="Postulate"
      >readFiniteFile</a
      > = readFiniteFile                        <a name="2856" class="Symbol"
      >#-}</a
      >
<a name="2860" class="Symbol"
      >{-#</a
      > <a name="2864" class="Keyword"
      >COMPILE</a
      > UHC <a name="2876" href="IO.Primitive.html#getContents" class="Postulate"
      >getContents</a
      >    = UHC.Agda.Builtins.primGetContents     <a name="2931" class="Symbol"
      >#-}</a
      >
<a name="2935" class="Symbol"
      >{-#</a
      > <a name="2939" class="Keyword"
      >COMPILE</a
      > UHC <a name="2951" href="IO.Primitive.html#readFile" class="Postulate"
      >readFile</a
      >       = UHC.Agda.Builtins.primReadFile        <a name="3006" class="Symbol"
      >#-}</a
      >
<a name="3010" class="Symbol"
      >{-#</a
      > <a name="3014" class="Keyword"
      >COMPILE</a
      > UHC <a name="3026" href="IO.Primitive.html#writeFile" class="Postulate"
      >writeFile</a
      >      = UHC.Agda.Builtins.primWriteFile       <a name="3081" class="Symbol"
      >#-}</a
      >
<a name="3085" class="Symbol"
      >{-#</a
      > <a name="3089" class="Keyword"
      >COMPILE</a
      > UHC <a name="3101" href="IO.Primitive.html#appendFile" class="Postulate"
      >appendFile</a
      >     = UHC.Agda.Builtins.primAppendFile      <a name="3156" class="Symbol"
      >#-}</a
      >
<a name="3160" class="Symbol"
      >{-#</a
      > <a name="3164" class="Keyword"
      >COMPILE</a
      > UHC <a name="3176" href="IO.Primitive.html#putStr" class="Postulate"
      >putStr</a
      >         = UHC.Agda.Builtins.primPutStr          <a name="3231" class="Symbol"
      >#-}</a
      >
<a name="3235" class="Symbol"
      >{-#</a
      > <a name="3239" class="Keyword"
      >COMPILE</a
      > UHC <a name="3251" href="IO.Primitive.html#putStrLn" class="Postulate"
      >putStrLn</a
      >       = UHC.Agda.Builtins.primPutStrLn        <a name="3306" class="Symbol"
      >#-}</a
      >
<a name="3310" class="Symbol"
      >{-#</a
      > <a name="3314" class="Keyword"
      >COMPILE</a
      > UHC <a name="3326" href="IO.Primitive.html#readFiniteFile" class="Postulate"
      >readFiniteFile</a
      > = UHC.Agda.Builtins.primReadFiniteFile  <a name="3381" class="Symbol"
      >#-}</a
      >
</pre
    ></body
  ></html
>
