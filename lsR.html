<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>lsR</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="lsR.html" class="Module">lsR</a> <a id="12" class="Keyword">where</a>

<a id="19" class="Keyword">open</a> <a id="24" class="Keyword">import</a> <a id="31" href="Level.html" class="Module">Level</a>
<a id="37" class="Keyword">open</a> <a id="42" class="Keyword">import</a> <a id="49" href="Size.html" class="Module">Size</a>
<a id="54" class="Keyword">open</a> <a id="59" class="Keyword">import</a> <a id="66" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="76" class="Keyword">open</a> <a id="81" class="Keyword">import</a> <a id="88" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="103" class="Symbol">as</a> <a id="106" class="Module">List</a> <a id="111" class="Keyword">using</a> <a id="117" class="Symbol">(</a><a id="118" href="Agda.Builtin.List.html#121" class="Datatype">List</a><a id="122" class="Symbol">;</a> <a id="124" href="Data.List.Base.html#8910" class="InductiveConstructor">[]</a><a id="126" class="Symbol">;</a> <a id="128" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">_∷_</a><a id="131" class="Symbol">)</a>
<a id="133" class="Keyword">open</a> <a id="138" class="Keyword">import</a> <a id="145" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="159" class="Keyword">open</a> <a id="164" class="Keyword">import</a> <a id="171" href="Data.Product.html" class="Module">Data.Product</a>
<a id="184" class="Keyword">open</a> <a id="189" class="Keyword">import</a> <a id="196" href="Data.String.Base.html" class="Module">Data.String.Base</a>
<a id="213" class="Keyword">open</a> <a id="218" class="Keyword">import</a> <a id="225" href="Data.String.Extras.html" class="Module">Data.String.Extras</a>
<a id="244" class="Keyword">open</a> <a id="249" class="Keyword">import</a> <a id="256" href="Codata.IO.html" class="Module">Codata.IO</a>
<a id="266" class="Keyword">open</a> <a id="271" class="Keyword">import</a> <a id="278" href="Codata.Thunk.html" class="Module">Codata.Thunk</a>
<a id="291" class="Keyword">open</a> <a id="296" class="Keyword">import</a> <a id="303" href="Function.html" class="Module">Function</a>
<a id="312" class="Keyword">open</a> <a id="317" class="Keyword">import</a> <a id="324" href="System.Environment.html" class="Module">System.Environment</a>
<a id="343" class="Keyword">open</a> <a id="348" class="Keyword">import</a> <a id="355" href="System.FilePath.Posix.html" class="Module">System.FilePath.Posix</a>
<a id="377" class="Keyword">open</a> <a id="382" class="Keyword">import</a> <a id="389" href="System.Directory.html" class="Module">System.Directory</a>
<a id="406" class="Keyword">open</a> <a id="411" class="Keyword">import</a> <a id="418" href="System.Directory.Tree.html" class="Module">System.Directory.Tree</a>

<a id="printTree"></a><a id="441" href="lsR.html#441" class="Function">printTree</a> <a id="451" class="Symbol">:</a> <a id="453" class="Symbol">∀</a> <a id="455" class="Symbol">{</a><a id="456" href="lsR.html#456" class="Bound">i</a><a id="457" class="Symbol">}</a> <a id="459" class="Symbol">→</a> <a id="461" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="468" class="Symbol">→</a> <a id="470" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="475" class="Symbol">(</a><a id="476" href="Codata.IO.Core.html#278" class="Datatype">IO′</a> <a id="480" href="Level.html#512" class="Function">0ℓ</a> <a id="483" href="System.Directory.Tree.html#747" class="Function">RelativeTree</a> <a id="496" href="lsR.html#456" class="Bound">i</a><a id="497" class="Symbol">)</a> <a id="499" class="Symbol">→</a> <a id="501" href="Codata.IO.Core.html#278" class="Datatype">IO′</a> <a id="505" href="Level.html#512" class="Function">0ℓ</a> <a id="508" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a> <a id="510" href="lsR.html#456" class="Bound">i</a>
<a id="512" href="lsR.html#441" class="Function">printTree</a> <a id="522" href="lsR.html#522" class="Bound">pad</a> <a id="526" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>           <a id="539" class="Symbol">=</a> <a id="541" href="Codata.IO.Core.html#549" class="Function">pure</a> <a id="546" class="Symbol">_</a>
<a id="548" href="lsR.html#441" class="Function">printTree</a> <a id="558" href="lsR.html#558" class="Bound">pad</a> <a id="562" class="Symbol">(</a><a id="563" href="lsR.html#563" class="Bound">iot</a> <a id="567" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="569" href="lsR.html#569" class="Bound">iots</a><a id="573" class="Symbol">)</a> <a id="575" class="Symbol">=</a> <a id="577" href="lsR.html#563" class="Bound">iot</a> <a id="581" href="Codata.IO.html#1161" class="Function Operator">&gt;&gt;=ᵗ</a> <a id="586" class="Symbol">λ</a> <a id="588" class="Keyword">where</a>
  <a id="596" class="Symbol">(</a><a id="597" href="lsR.html#597" class="Bound">dir</a> <a id="601" href="System.Directory.Tree.html#390" class="InductiveConstructor Operator">∋</a> <a id="603" href="lsR.html#603" class="Bound">fs</a> <a id="606" href="System.Directory.Tree.html#390" class="InductiveConstructor Operator">:&lt;</a> <a id="609" href="lsR.html#609" class="Bound">ds</a><a id="611" class="Symbol">)</a> <a id="613" class="Symbol">.</a><a id="614" href="Codata.Thunk.html#544" class="Field">force</a> <a id="620" class="Symbol">→</a> <a id="622" class="Keyword">do</a>
    <a id="629" href="Codata.IO.html#4247" class="Function">putStrLn</a> <a id="638" class="Symbol">(</a><a id="639" href="lsR.html#558" class="Bound">pad</a> <a id="643" href="Data.String.Base.html#1744" class="Function Operator">++</a> <a id="646" href="System.FilePath.Posix.Primitive.html#1123" class="Postulate">getFilePath</a> <a id="658" href="lsR.html#597" class="Bound">dir</a><a id="661" class="Symbol">)</a>
    <a id="667" class="Keyword">let</a> <a id="671" href="lsR.html#671" class="Bound">pad′</a> <a id="676" class="Symbol">=</a> <a id="678" class="String">&quot;  &quot;</a> <a id="683" href="Data.String.Base.html#1744" class="Function Operator">++</a> <a id="686" href="lsR.html#558" class="Bound">pad</a>
    <a id="694" href="Codata.IO.html#2269" class="Function">ListIO.mapM′</a> <a id="707" class="Symbol">(λ</a> <a id="710" href="lsR.html#710" class="Bound">fp</a> <a id="713" class="Symbol">→</a> <a id="715" href="Codata.IO.html#4247" class="Function">putStrLn</a> <a id="724" class="Symbol">(</a><a id="725" href="lsR.html#671" class="Bound">pad′</a> <a id="730" href="Data.String.Base.html#1744" class="Function Operator">++</a> <a id="733" href="System.FilePath.Posix.Primitive.html#1123" class="Postulate">getFilePath</a> <a id="745" href="lsR.html#710" class="Bound">fp</a><a id="747" class="Symbol">))</a> <a id="750" href="lsR.html#603" class="Bound">fs</a>
    <a id="757" class="Keyword">let</a> <a id="761" href="lsR.html#761" class="Bound">ds</a> <a id="764" class="Symbol">=</a> <a id="766" href="Data.List.Base.html#1304" class="Function">List.map</a> <a id="775" class="Symbol">((</a><a id="777" href="System.Directory.Tree.html#1730" class="Function">tree#</a> <a id="783" href="Codata.IO.html#1304" class="Function Operator">&lt;$&gt;_</a><a id="787" class="Symbol">)</a> <a id="789" href="Function.Core.html#3365" class="Function Operator">∘′</a> <a id="792" href="Agda.Builtin.Sigma.html#237" class="Field">proj₂</a><a id="797" class="Symbol">)</a> <a id="799" href="lsR.html#609" class="Bound">ds</a>
    <a id="806" href="lsR.html#441" class="Function">printTree</a> <a id="816" href="lsR.html#671" class="Bound">pad′</a> <a id="821" href="lsR.html#761" class="Bound">ds</a>
    <a id="828" href="lsR.html#441" class="Function">printTree</a> <a id="838" href="lsR.html#558" class="Bound">pad</a> <a id="842" href="lsR.html#569" class="Bound">iots</a>

<a id="usage"></a><a id="848" href="lsR.html#848" class="Function">usage</a> <a id="854" class="Symbol">:</a> <a id="856" href="Codata.IO.Core.html#624" class="Function">IO</a> <a id="859" href="Level.html#512" class="Function">0ℓ</a> <a id="862" class="Symbol">_</a>
<a id="864" href="lsR.html#848" class="Function">usage</a> <a id="870" class="Symbol">=</a> <a id="872" href="Codata.IO.html#4247" class="Function">putStrLn</a> <a id="881" class="String">&quot;Requires one argument: root filepath&quot;</a>

<a id="main"></a><a id="921" href="lsR.html#921" class="Function">main</a> <a id="926" class="Symbol">=</a> <a id="928" href="Codata.IO.html#5211" class="Function">run</a> <a id="932" href="Function.Core.html#1710" class="Function Operator">$</a> <a id="934" class="Keyword">do</a>
  <a id="939" class="Symbol">(</a><a id="940" href="lsR.html#940" class="Bound">fp</a> <a id="943" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="945" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a><a id="947" class="Symbol">)</a> <a id="949" href="Codata.IO.html#875" class="Function Operator">←</a> <a id="951" href="System.Environment.html#371" class="Function">getArgs</a> <a id="959" class="Keyword">where</a> <a id="965" class="CatchallClause Symbol">_</a><a id="966" class="CatchallClause"> </a><a id="967" class="CatchallClause Symbol">→</a><a id="968" class="CatchallClause"> </a><a id="969" href="lsR.html#848" class="CatchallClause Function">usage</a>
  <a id="977" class="Keyword">let</a> <a id="981" href="lsR.html#981" class="Bound">dtree</a> <a id="987" class="Symbol">=</a> <a id="989" href="System.Directory.Tree.html#1785" class="Function">tree</a> <a id="994" href="Codata.IO.html#989" class="Function Operator">=&lt;&lt;</a> <a id="998" href="System.Directory.html#2065" class="Function">makeAbsolute</a> <a id="1011" class="Symbol">(</a><a id="1012" href="System.FilePath.Posix.Primitive.html#2131" class="Postulate">mkFilePath</a> <a id="1023" href="lsR.html#940" class="Bound">fp</a><a id="1025" class="Symbol">)</a>
  <a id="1029" href="lsR.html#441" class="Function">printTree</a> <a id="1039" class="String">&quot;&quot;</a> <a id="1042" class="Symbol">(</a><a id="1043" href="lsR.html#981" class="Bound">dtree</a> <a id="1049" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1051" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a><a id="1053" class="Symbol">)</a>
</pre></body></html>