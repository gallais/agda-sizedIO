<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>lsR</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="lsR.html" class="Module">lsR</a> <a id="12" class="Keyword">where</a>

<a id="19" class="Keyword">open</a> <a id="24" class="Keyword">import</a> <a id="31" href="Level.html" class="Module">Level</a>
<a id="37" class="Keyword">open</a> <a id="42" class="Keyword">import</a> <a id="49" href="Size.html" class="Module">Size</a>
<a id="54" class="Keyword">open</a> <a id="59" class="Keyword">import</a> <a id="66" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="76" class="Keyword">open</a> <a id="81" class="Keyword">import</a> <a id="88" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="98" class="Keyword">open</a> <a id="103" class="Keyword">import</a> <a id="110" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="125" class="Symbol">as</a> <a id="128" class="Module">List</a> <a id="133" class="Keyword">using</a> <a id="139" class="Symbol">(</a><a id="140" href="Agda.Builtin.List.html#121" class="Datatype">List</a><a id="144" class="Symbol">;</a> <a id="146" href="Data.List.Base.html#8910" class="InductiveConstructor">[]</a><a id="148" class="Symbol">;</a> <a id="150" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">_∷_</a><a id="153" class="Symbol">;</a> <a id="155" href="Data.List.Base.html#8764" class="Function Operator">_∷ʳ_</a><a id="159" class="Symbol">)</a>
<a id="161" class="Keyword">import</a> <a id="168" href="Data.List.Categorical.html" class="Module">Data.List.Categorical</a> <a id="190" class="Symbol">as</a> <a id="193" class="Module">List</a><a id="197" class="Symbol">;</a> <a id="199" class="Keyword">open</a> <a id="204" href="Data.List.Categorical.html#1738" class="Module">List.TraversableA</a>
<a id="222" class="Keyword">open</a> <a id="227" class="Keyword">import</a> <a id="234" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="250" class="Keyword">using</a> <a id="256" class="Symbol">(</a><a id="257" href="Data.Maybe.Base.html#800" class="Datatype">Maybe</a><a id="262" class="Symbol">;</a> <a id="264" href="Data.Maybe.Base.html#834" class="InductiveConstructor">nothing</a><a id="271" class="Symbol">;</a> <a id="273" href="Data.Maybe.Base.html#854" class="InductiveConstructor">just</a><a id="277" class="Symbol">)</a>
<a id="279" class="Keyword">import</a> <a id="286" href="Data.Maybe.Categorical.html" class="Module">Data.Maybe.Categorical</a> <a id="309" class="Symbol">as</a> <a id="312" class="Module">Maybe</a>
<a id="318" class="Keyword">open</a> <a id="323" class="Keyword">import</a> <a id="330" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="344" class="Keyword">open</a> <a id="349" class="Keyword">import</a> <a id="356" href="Data.Product.html" class="Module">Data.Product</a>
<a id="369" class="Keyword">open</a> <a id="374" class="Keyword">import</a> <a id="381" href="Data.String.Base.html" class="Module">Data.String.Base</a>
<a id="398" class="Keyword">open</a> <a id="403" class="Keyword">import</a> <a id="410" href="Codata.IO.html" class="Module">Codata.IO</a>
<a id="420" class="Keyword">open</a> <a id="425" class="Keyword">import</a> <a id="432" href="Codata.Thunk.html" class="Module">Codata.Thunk</a>
<a id="445" class="Keyword">open</a> <a id="450" class="Keyword">import</a> <a id="457" href="Function.html" class="Module">Function</a>
<a id="466" class="Keyword">open</a> <a id="471" class="Keyword">import</a> <a id="478" href="System.Environment.html" class="Module">System.Environment</a>
<a id="497" class="Keyword">open</a> <a id="502" class="Keyword">import</a> <a id="509" href="System.FilePath.Posix.html" class="Module">System.FilePath.Posix</a>
<a id="531" class="Keyword">open</a> <a id="536" class="Keyword">import</a> <a id="543" href="System.Directory.html" class="Module">System.Directory</a>
<a id="560" class="Keyword">open</a> <a id="565" class="Keyword">import</a> <a id="572" href="System.Directory.Tree.html" class="Module">System.Directory.Tree</a>

<a id="padding"></a><a id="595" href="lsR.html#595" class="Function">padding</a> <a id="603" class="Symbol">:</a> <a id="605" href="Agda.Builtin.Bool.html#135" class="Datatype">Bool</a> <a id="610" class="Symbol">→</a> <a id="612" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="617" href="Agda.Builtin.Bool.html#135" class="Datatype">Bool</a> <a id="622" class="Symbol">→</a> <a id="624" href="Agda.Builtin.String.html#247" class="Postulate">String</a>
<a id="631" href="lsR.html#595" class="Function">padding</a> <a id="639" href="lsR.html#639" class="Bound">dir?</a> <a id="644" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>       <a id="653" class="Symbol">=</a> <a id="655" class="String">&quot;&quot;</a>
<a id="658" href="lsR.html#595" class="Function">padding</a> <a id="666" href="lsR.html#666" class="Bound">dir?</a> <a id="671" class="Symbol">(</a><a id="672" href="lsR.html#672" class="Bound">b</a> <a id="674" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="676" href="lsR.html#676" class="Bound">bs</a><a id="678" class="Symbol">)</a> <a id="680" class="Symbol">=</a>
  <a id="684" class="Symbol">(</a><a id="685" href="Data.Bool.Base.html#1312" class="Function Operator">if</a> <a id="688" href="lsR.html#666" class="Bound">dir?</a> <a id="693" href="Data.Bool.Base.html#1015" class="Function Operator">∧</a> <a id="695" href="Data.List.Base.html#3763" class="Function">List.null</a> <a id="705" href="lsR.html#676" class="Bound">bs</a>
   <a id="711" href="Data.Bool.Base.html#1312" class="Function Operator">then</a> <a id="716" href="Data.Bool.Base.html#1312" class="Function Operator">if</a> <a id="719" href="lsR.html#672" class="Bound">b</a> <a id="721" href="Data.Bool.Base.html#1312" class="Function Operator">then</a> <a id="726" class="String">&quot; ├ &quot;</a> <a id="732" href="Data.Bool.Base.html#1312" class="Function Operator">else</a> <a id="737" class="String">&quot; └ &quot;</a>
   <a id="746" href="Data.Bool.Base.html#1312" class="Function Operator">else</a> <a id="751" href="Data.Bool.Base.html#1312" class="Function Operator">if</a> <a id="754" href="lsR.html#672" class="Bound">b</a> <a id="756" href="Data.Bool.Base.html#1312" class="Function Operator">then</a> <a id="761" class="String">&quot; │&quot;</a>  <a id="767" href="Data.Bool.Base.html#1312" class="Function Operator">else</a> <a id="772" class="String">&quot;  &quot;</a><a id="776" class="Symbol">)</a>
  <a id="780" href="Data.String.Base.html#1744" class="Function Operator">++</a> <a id="783" href="lsR.html#595" class="Function">padding</a> <a id="791" href="lsR.html#666" class="Bound">dir?</a> <a id="796" href="lsR.html#676" class="Bound">bs</a>

<a id="prefixes"></a><a id="800" href="lsR.html#800" class="Function">prefixes</a> <a id="809" class="Symbol">:</a> <a id="811" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="813" class="Symbol">→</a> <a id="815" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="820" href="Agda.Builtin.Bool.html#135" class="Datatype">Bool</a>
<a id="825" href="lsR.html#800" class="Function">prefixes</a> <a id="834" href="lsR.html#834" class="Bound">n</a> <a id="836" class="Symbol">=</a> <a id="838" href="Data.List.Base.html#4379" class="Function">List.replicate</a> <a id="853" class="Symbol">(</a><a id="854" href="lsR.html#834" class="Bound">n</a> <a id="856" href="Agda.Builtin.Nat.html#388" class="Primitive Operator">∸</a> <a id="858" class="Number">1</a><a id="859" class="Symbol">)</a> <a id="861" href="Agda.Builtin.Bool.html#160" class="InductiveConstructor">true</a> <a id="866" href="Data.List.Base.html#8764" class="Function Operator">∷ʳ</a> <a id="869" href="Agda.Builtin.Bool.html#154" class="InductiveConstructor">false</a>

<a id="printSubTrees"></a><a id="876" href="lsR.html#876" class="Function">printSubTrees</a> <a id="890" class="Symbol">:</a> <a id="892" class="Symbol">∀</a> <a id="894" class="Symbol">{</a><a id="895" href="lsR.html#895" class="Bound">i</a><a id="896" class="Symbol">}</a> <a id="898" class="Symbol">→</a> <a id="900" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="905" class="Symbol">(</a><a id="906" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="911" href="Agda.Builtin.Bool.html#135" class="Datatype">Bool</a> <a id="916" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="918" href="Codata.IO.Core.html#278" class="Datatype">IO′</a> <a id="922" href="Level.html#512" class="Function">0ℓ</a> <a id="925" class="Symbol">(</a><a id="926" href="System.Directory.Tree.html#651" class="Function">Tree</a> <a id="931" href="System.Directory.html#611" class="Generalizable">n</a><a id="932" class="Symbol">)</a> <a id="934" href="lsR.html#895" class="Bound">i</a><a id="935" class="Symbol">)</a> <a id="937" class="Symbol">→</a> <a id="939" href="Codata.IO.Core.html#278" class="Datatype">IO′</a> <a id="943" href="Level.html#512" class="Function">0ℓ</a> <a id="946" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a> <a id="948" href="lsR.html#895" class="Bound">i</a>
<a id="950" href="lsR.html#876" class="Function">printSubTrees</a> <a id="964" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>                  <a id="984" class="Symbol">=</a> <a id="986" href="Codata.IO.Core.html#549" class="Function">pure</a> <a id="991" class="Symbol">_</a>
<a id="993" href="lsR.html#876" class="Function">printSubTrees</a> <a id="1007" class="Symbol">((</a><a id="1009" href="lsR.html#1009" class="Bound">bs</a> <a id="1012" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1014" href="lsR.html#1014" class="Bound">iot</a><a id="1017" class="Symbol">)</a> <a id="1019" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1021" href="lsR.html#1021" class="Bound">iots</a><a id="1025" class="Symbol">)</a> <a id="1027" class="Symbol">=</a> <a id="1029" href="lsR.html#1014" class="Bound">iot</a> <a id="1033" href="Codata.IO.html#1161" class="Function Operator">&gt;&gt;=ᵗ</a> <a id="1038" class="Symbol">λ</a> <a id="1040" class="Keyword">where</a>
  <a id="1048" class="Symbol">(</a><a id="1049" href="lsR.html#1049" class="Bound">dir</a> <a id="1053" href="System.Directory.Tree.html#390" class="InductiveConstructor Operator">∋</a> <a id="1055" href="lsR.html#1055" class="Bound">fs</a> <a id="1058" href="System.Directory.Tree.html#390" class="InductiveConstructor Operator">:&lt;</a> <a id="1061" href="lsR.html#1061" class="Bound">ds</a><a id="1063" class="Symbol">)</a> <a id="1065" class="Symbol">.</a><a id="1066" href="Codata.Thunk.html#544" class="Field">force</a> <a id="1072" class="Symbol">→</a> <a id="1074" class="Keyword">do</a>
    <a id="1081" class="Keyword">let</a> <a id="1085" href="lsR.html#1085" class="Bound">bs′</a> <a id="1089" class="Symbol">=</a> <a id="1091" href="Data.List.Base.html#8564" class="Function">List.reverse</a> <a id="1104" href="lsR.html#1009" class="Bound">bs</a>
    <a id="1111" href="Codata.IO.html#4948" class="Function">putStrLn</a> <a id="1120" class="Symbol">(</a><a id="1121" href="lsR.html#595" class="Function">padding</a> <a id="1129" href="Agda.Builtin.Bool.html#160" class="InductiveConstructor">true</a> <a id="1134" href="lsR.html#1085" class="Bound">bs′</a> <a id="1138" href="Data.String.Base.html#1744" class="Function Operator">++</a> <a id="1141" href="System.FilePath.Posix.Primitive.html#1123" class="Postulate">getFilePath</a> <a id="1153" href="lsR.html#1049" class="Bound">dir</a><a id="1156" class="Symbol">)</a>
    <a id="1162" class="Keyword">let</a> <a id="1166" href="lsR.html#1166" class="Bound">pad</a> <a id="1170" class="Symbol">=</a> <a id="1172" href="lsR.html#595" class="Function">padding</a> <a id="1180" href="Agda.Builtin.Bool.html#154" class="InductiveConstructor">false</a> <a id="1186" href="lsR.html#1085" class="Bound">bs′</a>
    <a id="1194" class="Keyword">let</a> <a id="1198" href="lsR.html#1198" class="Bound">pads</a> <a id="1203" class="Symbol">=</a> <a id="1205" href="lsR.html#800" class="Function">prefixes</a> <a id="1214" class="Symbol">(</a><a id="1215" href="Data.List.Base.html#4104" class="Function">List.length</a> <a id="1227" href="lsR.html#1055" class="Bound">fs</a> <a id="1230" href="Agda.Builtin.Nat.html#298" class="Primitive Operator">+</a> <a id="1232" href="Data.List.Base.html#4104" class="Function">List.length</a> <a id="1244" href="lsR.html#1061" class="Bound">ds</a><a id="1246" class="Symbol">)</a>
    <a id="1252" href="Codata.IO.html#2418" class="Function">ListIO.forM′</a> <a id="1265" class="Symbol">(</a><a id="1266" href="Data.List.Base.html#3050" class="Function">List.zip</a> <a id="1275" href="lsR.html#1198" class="Bound">pads</a> <a id="1280" href="lsR.html#1055" class="Bound">fs</a><a id="1282" class="Symbol">)</a> <a id="1284" href="Function.Core.html#1710" class="Function Operator">$</a> <a id="1286" class="Symbol">λ</a> <a id="1288" class="Symbol">(</a><a id="1289" href="lsR.html#1289" class="Bound">b</a> <a id="1291" href="lsR.html#1289" class="Bound">,</a> <a id="1293" href="lsR.html#1289" class="Bound">fp</a><a id="1295" class="Symbol">)</a> <a id="1297" class="Symbol">→</a> <a id="1299" class="Keyword">do</a>
      <a id="1308" href="Codata.IO.html#4948" class="Function">putStrLn</a> <a id="1317" class="Symbol">(</a><a id="1318" href="lsR.html#1166" class="Bound">pad</a> <a id="1322" href="Data.String.Base.html#1744" class="Function Operator">++</a> <a id="1325" class="Symbol">(</a><a id="1326" href="Data.Bool.Base.html#1312" class="Function Operator">if</a> <a id="1329" href="lsR.html#1289" class="Bound">b</a> <a id="1331" href="Data.Bool.Base.html#1312" class="Function Operator">then</a> <a id="1336" class="String">&quot; ├ &quot;</a> <a id="1342" href="Data.Bool.Base.html#1312" class="Function Operator">else</a> <a id="1347" class="String">&quot; └ &quot;</a><a id="1352" class="Symbol">)</a> <a id="1354" href="Data.String.Base.html#1744" class="Function Operator">++</a> <a id="1357" href="System.FilePath.Posix.Primitive.html#1123" class="Postulate">getFilePath</a> <a id="1369" href="lsR.html#1293" class="Bound">fp</a><a id="1371" class="Symbol">)</a>
    <a id="1377" class="Keyword">let</a> <a id="1381" href="lsR.html#1381" class="Bound">ds</a> <a id="1384" class="Symbol">=</a> <a id="1386" href="Data.List.Base.html#1304" class="Function">List.map</a> <a id="1395" class="Symbol">((</a><a id="1397" href="System.Directory.Tree.html#1730" class="Function">tree#</a> <a id="1403" href="Codata.IO.html#1304" class="Function Operator">&lt;$&gt;_</a><a id="1407" class="Symbol">)</a> <a id="1409" href="Function.Core.html#3365" class="Function Operator">∘′</a> <a id="1412" href="Agda.Builtin.Sigma.html#237" class="Field">proj₂</a><a id="1417" class="Symbol">)</a> <a id="1419" href="lsR.html#1061" class="Bound">ds</a>
    <a id="1426" class="Keyword">let</a> <a id="1430" href="lsR.html#1430" class="Bound">bs</a> <a id="1433" class="Symbol">=</a> <a id="1435" href="Data.List.Base.html#1304" class="Function">List.map</a> <a id="1444" class="Symbol">(</a><a id="1445" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">_∷</a> <a id="1448" href="lsR.html#1009" class="Bound">bs</a><a id="1450" class="Symbol">)</a> <a id="1452" class="Symbol">(</a><a id="1453" href="lsR.html#800" class="Function">prefixes</a> <a id="1462" class="Symbol">(</a><a id="1463" href="Data.List.Base.html#4104" class="Function">List.length</a> <a id="1475" href="lsR.html#1381" class="Bound">ds</a><a id="1477" class="Symbol">))</a>
    <a id="1484" href="lsR.html#876" class="Function">printSubTrees</a> <a id="1498" class="Symbol">(</a><a id="1499" href="Data.List.Base.html#3050" class="Function">List.zip</a> <a id="1508" href="lsR.html#1430" class="Bound">bs</a> <a id="1511" href="lsR.html#1381" class="Bound">ds</a><a id="1513" class="Symbol">)</a>
    <a id="1519" href="lsR.html#876" class="Function">printSubTrees</a> <a id="1533" href="lsR.html#1021" class="Bound">iots</a>

<a id="1539" class="Comment">-- printTree remembers to preserve the current directory:</a>
<a id="1597" class="Comment">-- exploring the directory tree has side-effects such as</a>
<a id="1654" class="Comment">-- changing the current working directory.</a>
<a id="printTree"></a><a id="1697" href="lsR.html#1697" class="Function">printTree</a> <a id="1707" class="Symbol">:</a> <a id="1709" href="System.Directory.Tree.html#651" class="Function">Tree</a> <a id="1714" href="System.Directory.html#611" class="Generalizable">n</a> <a id="1716" class="Symbol">→</a> <a id="1718" href="Codata.IO.Core.html#624" class="Function">IO</a> <a id="1721" href="Level.html#512" class="Function">0ℓ</a> <a id="1724" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a>
<a id="1726" href="lsR.html#1697" class="Function">printTree</a> <a id="1736" href="lsR.html#1736" class="Bound">t</a> <a id="1738" class="Symbol">=</a> <a id="1740" href="System.Directory.html#1215" class="Function">withCurrentDirectory</a> <a id="1761" href="System.FilePath.Posix.html#2221" class="Function">currentDirectory</a> <a id="1778" href="Function.Core.html#1710" class="Function Operator">$</a>
  <a id="1782" href="lsR.html#876" class="Function">printSubTrees</a> <a id="1796" class="Symbol">((</a><a id="1798" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="1801" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1803" href="Codata.IO.Core.html#549" class="Function">pure</a> <a id="1808" href="lsR.html#1736" class="Bound">t</a><a id="1809" class="Symbol">)</a> <a id="1811" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1813" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a><a id="1815" class="Symbol">)</a>

<a id="printTreeAt"></a><a id="1818" href="lsR.html#1818" class="Function">printTreeAt</a> <a id="1830" class="Symbol">:</a> <a id="1832" href="System.FilePath.Posix.Primitive.html#1093" class="Postulate">FilePath</a> <a id="1841" href="System.Directory.html#611" class="Generalizable">n</a> <a id="1843" class="Symbol">→</a> <a id="1845" href="Codata.IO.Core.html#624" class="Function">IO</a> <a id="1848" href="Level.html#512" class="Function">0ℓ</a> <a id="1851" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a>
<a id="1853" href="lsR.html#1818" class="Function">printTreeAt</a> <a id="1865" href="lsR.html#1865" class="Bound">fp</a> <a id="1868" class="Symbol">=</a> <a id="1870" href="System.Directory.html#1215" class="Function">withCurrentDirectory</a> <a id="1891" href="System.FilePath.Posix.html#2221" class="Function">currentDirectory</a> <a id="1908" href="Function.Core.html#1710" class="Function Operator">$</a>
  <a id="1912" href="lsR.html#1697" class="Function">printTree</a> <a id="1922" href="Codata.IO.html#989" class="Function Operator">=&lt;&lt;</a> <a id="1926" href="System.Directory.Tree.html#1785" class="Function">tree</a> <a id="1931" class="Symbol">{{</a><a id="1933" href="System.FilePath.Posix.html#2181" class="InductiveConstructor">relative</a><a id="1941" class="Symbol">}}</a> <a id="1944" href="lsR.html#1865" class="Bound">fp</a>

<a id="usage"></a><a id="1948" href="lsR.html#1948" class="Function">usage</a> <a id="1954" class="Symbol">:</a> <a id="1956" href="Codata.IO.Core.html#624" class="Function">IO</a> <a id="1959" href="Level.html#512" class="Function">0ℓ</a> <a id="1962" class="Symbol">_</a>
<a id="1964" href="lsR.html#1948" class="Function">usage</a> <a id="1970" class="Symbol">=</a> <a id="1972" href="Codata.IO.html#4948" class="Function">putStrLn</a> <a id="1981" class="String">&quot;Requires a non-empty list of paths to directories&quot;</a>

<a id="isDirectoryPath"></a><a id="2034" href="lsR.html#2034" class="Function">isDirectoryPath</a> <a id="2050" class="Symbol">:</a> <a id="2052" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="2059" class="Symbol">→</a> <a id="2061" href="Codata.IO.Core.html#624" class="Function">IO</a> <a id="2064" href="System.Directory.html#596" class="Generalizable">ℓ</a> <a id="2066" class="Symbol">(</a><a id="2067" href="Data.Maybe.Base.html#800" class="Datatype">Maybe</a> <a id="2073" href="System.FilePath.Posix.Primitive.html#1883" class="Function">SomePath</a><a id="2081" class="Symbol">)</a>
<a id="2083" href="lsR.html#2034" class="Function">isDirectoryPath</a> <a id="2099" href="lsR.html#2099" class="Bound">str</a> <a id="2103" class="Symbol">=</a> <a id="2105" class="Keyword">do</a>
  <a id="2110" class="Keyword">let</a> <a id="2114" href="lsR.html#2114" class="Bound">fp</a> <a id="2117" class="Symbol">=</a> <a id="2119" href="System.FilePath.Posix.Primitive.html#2170" class="Postulate">mkFilePath</a> <a id="2130" href="lsR.html#2099" class="Bound">str</a>
  <a id="2136" href="lsR.html#2136" class="Bound">b</a> <a id="2138" href="Codata.IO.html#875" class="Function Operator">←</a> <a id="2140" href="System.Directory.html#2761" class="Function">doesDirectoryExist</a> <a id="2159" href="lsR.html#2114" class="Bound">fp</a>
  <a id="2164" href="Codata.IO.Core.html#549" class="Function">pure</a> <a id="2169" href="Function.Core.html#1710" class="Function Operator">$</a> <a id="2171" href="Data.Bool.Base.html#1312" class="Function Operator">if</a> <a id="2174" href="lsR.html#2136" class="Bound">b</a> <a id="2176" href="Data.Bool.Base.html#1312" class="Function Operator">then</a> <a id="2181" href="Data.Maybe.Base.html#854" class="InductiveConstructor">just</a> <a id="2186" href="lsR.html#2114" class="Bound">fp</a> <a id="2189" href="Data.Bool.Base.html#1312" class="Function Operator">else</a> <a id="2194" href="Data.Maybe.Base.html#834" class="InductiveConstructor">nothing</a>

<a id="main"></a><a id="2203" href="lsR.html#2203" class="Function">main</a> <a id="2208" class="Symbol">=</a> <a id="2210" href="Codata.IO.html#5912" class="Function">run</a> <a id="2214" href="Function.Core.html#1710" class="Function Operator">$</a> <a id="2216" class="Keyword">do</a>
  <a id="2221" class="Comment">-- make sure all the arguments passed are paths to directories</a>
  <a id="2286" href="lsR.html#2286" class="Bound">fps</a> <a id="2290" href="Codata.IO.html#875" class="Function Operator">←</a> <a id="2292" href="Codata.IO.html#2178" class="Function">ListIO.mapM</a> <a id="2304" href="lsR.html#2034" class="Function">isDirectoryPath</a> <a id="2320" href="Codata.IO.html#989" class="Function Operator">=&lt;&lt;</a> <a id="2324" href="System.Environment.html#371" class="Function">getArgs</a>
  <a id="2334" href="Function.Core.html#3716" class="Function Operator">case</a> <a id="2339" href="Data.List.Categorical.html#1822" class="Function">sequenceA</a> <a id="2349" href="Data.Maybe.Categorical.html#646" class="Function">Maybe.applicative</a> <a id="2367" href="lsR.html#2286" class="Bound">fps</a> <a id="2371" href="Function.Core.html#3716" class="Function Operator">of</a> <a id="2374" class="Symbol">λ</a> <a id="2376" class="Keyword">where</a>
    <a id="2386" class="Comment">-- make sure at least one argument was passed</a>
    <a id="2436" class="Symbol">(</a><a id="2437" href="Data.Maybe.Base.html#854" class="InductiveConstructor">just</a> <a id="2442" href="lsR.html#2442" class="Bound">fps</a><a id="2445" class="Symbol">@(_</a> <a id="2449" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="2451" class="Symbol">_))</a> <a id="2455" class="Symbol">→</a> <a id="2457" href="Codata.IO.html#2269" class="Function">ListIO.mapM′</a> <a id="2470" href="lsR.html#1818" class="Function">printTreeAt</a> <a id="2482" href="lsR.html#2442" class="Bound">fps</a>
    <a id="2490" class="CatchallClause Symbol">_</a> <a id="2492" class="Symbol">→</a> <a id="2494" href="lsR.html#1948" class="Function">usage</a>
</pre></body></html>