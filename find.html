<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>find</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="find.html" class="Module">find</a> <a id="13" class="Keyword">where</a>

<a id="20" class="Keyword">open</a> <a id="25" class="Keyword">import</a> <a id="32" href="Level.html" class="Module">Level</a>
<a id="38" class="Keyword">open</a> <a id="43" class="Keyword">import</a> <a id="50" href="Size.html" class="Module">Size</a>
<a id="55" class="Keyword">open</a> <a id="60" class="Keyword">import</a> <a id="67" href="Codata.IO.html" class="Module">Codata.IO</a>
<a id="77" class="Keyword">open</a> <a id="82" class="Keyword">import</a> <a id="89" href="Codata.Thunk.html" class="Module">Codata.Thunk</a>
<a id="102" class="Keyword">open</a> <a id="107" class="Keyword">import</a> <a id="114" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="129" class="Keyword">using</a> <a id="135" class="Symbol">(</a><a id="136" href="Data.Bool.Base.html#1312" class="Function Operator">if_then_else_</a><a id="149" class="Symbol">)</a>
<a id="151" class="Keyword">open</a> <a id="156" class="Keyword">import</a> <a id="163" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="178" class="Symbol">as</a> <a id="181" class="Module">List</a> <a id="186" class="Keyword">hiding</a> <a id="193" class="Symbol">(</a><a id="194" href="Data.List.Base.html#1570" class="Function Operator">_++_</a><a id="198" class="Symbol">)</a>
<a id="200" class="Keyword">open</a> <a id="205" class="Keyword">import</a> <a id="212" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="228" class="Keyword">using</a> <a id="234" class="Symbol">(</a><a id="235" href="Data.Maybe.Base.html#800" class="Datatype">Maybe</a><a id="240" class="Symbol">;</a> <a id="242" href="Data.Maybe.Base.html#834" class="InductiveConstructor">nothing</a><a id="249" class="Symbol">;</a> <a id="251" href="Data.Maybe.Base.html#854" class="InductiveConstructor">just</a><a id="255" class="Symbol">)</a>
<a id="257" class="Keyword">open</a> <a id="262" class="Keyword">import</a> <a id="269" href="Data.Product.html" class="Module">Data.Product</a>
<a id="282" class="Keyword">open</a> <a id="287" class="Keyword">import</a> <a id="294" href="Data.String.html" class="Module">Data.String</a>
<a id="306" class="Keyword">open</a> <a id="311" class="Keyword">import</a> <a id="318" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a>
<a id="332" class="Keyword">open</a> <a id="337" class="Keyword">import</a> <a id="344" href="Function.html" class="Module">Function</a>
<a id="353" class="Keyword">open</a> <a id="358" class="Keyword">import</a> <a id="365" href="System.Environment.html" class="Module">System.Environment</a>
<a id="384" class="Keyword">open</a> <a id="389" class="Keyword">import</a> <a id="396" href="System.FilePath.Posix.html" class="Module">System.FilePath.Posix</a>
<a id="418" class="Keyword">open</a> <a id="423" class="Keyword">import</a> <a id="430" href="System.Directory.html" class="Module">System.Directory</a>
<a id="447" class="Keyword">open</a> <a id="452" class="Keyword">import</a> <a id="459" href="System.Directory.Tree.html" class="Module">System.Directory.Tree</a>

<a id="482" class="Comment">-- @find str iots@ looks depth-first for a file with name @str@ in the</a>
<a id="553" class="Comment">-- list of subdirectories @iots@ left to process.</a>

<a id="find"></a><a id="604" href="find.html#604" class="Function">find</a> <a id="609" class="Symbol">:</a> <a id="611" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="618" class="Symbol">→</a> <a id="620" class="Symbol">∀</a> <a id="622" class="Symbol">{</a><a id="623" href="find.html#623" class="Bound">i</a><a id="624" class="Symbol">}</a> <a id="626" class="Symbol">→</a> <a id="628" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="633" class="Symbol">(</a><a id="634" href="Codata.IO.html#506" class="Datatype">IO′</a> <a id="638" href="Level.html#512" class="Function">0ℓ</a> <a id="641" href="System.Directory.Tree.html#743" class="Function">RelativeTree</a> <a id="654" href="find.html#623" class="Bound">i</a><a id="655" class="Symbol">)</a> <a id="657" class="Symbol">→</a> <a id="659" href="Codata.IO.html#506" class="Datatype">IO′</a> <a id="663" href="Level.html#512" class="Function">0ℓ</a> <a id="666" class="Symbol">(</a><a id="667" href="Data.Maybe.Base.html#800" class="Datatype">Maybe</a> <a id="673" href="System.FilePath.Posix.Primitive.html#1783" class="Function">AbsolutePath</a><a id="685" class="Symbol">)</a> <a id="687" href="find.html#623" class="Bound">i</a>
<a id="689" href="find.html#604" class="Function">find</a> <a id="694" href="find.html#694" class="Bound">str</a> <a id="698" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>           <a id="711" class="Symbol">=</a> <a id="713" href="Codata.IO.html#777" class="Function">pure</a> <a id="718" href="Data.Maybe.Base.html#834" class="InductiveConstructor">nothing</a>
<a id="726" href="find.html#604" class="Function">find</a> <a id="731" href="find.html#731" class="Bound">str</a> <a id="735" class="Symbol">(</a><a id="736" href="find.html#736" class="Bound">iot</a> <a id="740" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="742" href="find.html#742" class="Bound">iots</a><a id="746" class="Symbol">)</a> <a id="748" class="Symbol">=</a> <a id="750" href="find.html#736" class="Bound">iot</a> <a id="754" href="Codata.IO.html#1661" class="Function Operator">&gt;&gt;=ᵗ</a> <a id="759" class="Symbol">λ</a> <a id="761" class="Keyword">where</a>
  <a id="769" class="Symbol">(</a><a id="770" href="find.html#770" class="Bound">dir</a> <a id="774" href="System.Directory.Tree.html#390" class="InductiveConstructor Operator">∋</a> <a id="776" href="find.html#776" class="Bound">fs</a> <a id="779" href="System.Directory.Tree.html#390" class="InductiveConstructor Operator">:&lt;</a> <a id="782" href="find.html#782" class="Bound">ds</a><a id="784" class="Symbol">)</a> <a id="786" class="Symbol">.</a><a id="787" href="Codata.Thunk.html#544" class="Field">force</a> <a id="793" class="Symbol">→</a> <a id="795" class="Keyword">do</a>
    <a id="802" href="Function.Core.html#3716" class="Function Operator">case</a> <a id="807" href="Data.List.Base.html#7229" class="Function">List.filter</a> <a id="819" class="Symbol">((</a><a id="821" href="find.html#731" class="Bound">str</a> <a id="825" href="Data.String.Properties.html#2571" class="Function Operator">≟_</a><a id="827" class="Symbol">)</a> <a id="829" href="Function.Core.html#1164" class="Function Operator">∘</a> <a id="831" href="System.FilePath.Posix.Primitive.html#1103" class="Postulate">getFilePath</a><a id="842" class="Symbol">)</a> <a id="844" href="find.html#776" class="Bound">fs</a> <a id="847" href="Function.Core.html#3716" class="Function Operator">of</a> <a id="850" class="Symbol">λ</a> <a id="852" class="Keyword">where</a>
      <a id="864" class="Comment">-- if we have found a suitable file in the current directory</a>
      <a id="931" class="Comment">-- then we return it immediately</a>
      <a id="970" class="Symbol">(</a><a id="971" href="find.html#971" class="Bound">fp</a> <a id="974" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="976" class="Symbol">_)</a> <a id="979" class="Symbol">→</a> <a id="981" href="Codata.IO.html#777" class="Function">pure</a> <a id="986" class="Symbol">(</a><a id="987" href="Data.Maybe.Base.html#854" class="InductiveConstructor">just</a> <a id="992" class="Symbol">(</a><a id="993" href="System.FilePath.Posix.Primitive.html#3184" class="Postulate">combine</a> <a id="1001" href="find.html#770" class="Bound">dir</a> <a id="1005" href="find.html#971" class="Bound">fp</a><a id="1007" class="Symbol">))</a>
      <a id="1016" class="Comment">-- otherwise we look for it in its subdirectories. If we fail</a>
      <a id="1084" class="Comment">-- then we look at the next directory in the list.</a>
      <a id="1141" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>       <a id="1150" class="Symbol">→</a> <a id="1152" class="Keyword">do</a>
        <a id="1163" class="Keyword">let</a> <a id="1167" href="find.html#1167" class="Bound">ds</a> <a id="1170" class="Symbol">=</a> <a id="1172" href="Data.List.Base.html#1304" class="Function">List.map</a> <a id="1181" class="Symbol">((</a><a id="1183" href="System.Directory.Tree.html#1540" class="Function">tree#</a> <a id="1189" href="Codata.IO.html#1804" class="Function Operator">&lt;$&gt;_</a><a id="1193" class="Symbol">)</a> <a id="1195" href="Function.Core.html#3365" class="Function Operator">∘′</a> <a id="1198" href="Agda.Builtin.Sigma.html#237" class="Field">proj₂</a><a id="1203" class="Symbol">)</a> <a id="1205" href="find.html#782" class="Bound">ds</a>
        <a id="1216" href="Data.Maybe.Base.html#834" class="InductiveConstructor">nothing</a> <a id="1224" href="Codata.IO.html#1375" class="Function Operator">←</a> <a id="1226" href="find.html#604" class="Function">find</a> <a id="1231" href="find.html#731" class="Bound">str</a> <a id="1235" href="find.html#1167" class="Bound">ds</a> <a id="1238" class="Keyword">where</a> <a id="1244" href="find.html#1244" class="Bound">fp</a><a id="1246" class="Symbol">@(</a><a id="1248" href="Data.Maybe.Base.html#854" class="InductiveConstructor">just</a> <a id="1253" class="Symbol">_)</a> <a id="1256" class="Symbol">→</a> <a id="1258" href="Codata.IO.html#777" class="Function">pure</a> <a id="1263" href="find.html#1244" class="Bound">fp</a>
        <a id="1274" href="find.html#604" class="Function">find</a> <a id="1279" href="find.html#731" class="Bound">str</a> <a id="1283" href="find.html#742" class="Bound">iots</a>

<a id="usage"></a><a id="1289" href="find.html#1289" class="Function">usage</a> <a id="1295" class="Symbol">:</a> <a id="1297" href="Codata.IO.html#852" class="Function">IO</a> <a id="1300" href="Level.html#512" class="Function">0ℓ</a> <a id="1303" class="Symbol">_</a>
<a id="1305" href="find.html#1289" class="Function">usage</a> <a id="1311" class="Symbol">=</a> <a id="1313" href="Codata.IO.html#4715" class="Function">putStrLn</a> <a id="1322" class="String">&quot;Requires two arguments: root filepath and target file name&quot;</a>

<a id="main"></a><a id="1384" href="find.html#1384" class="Function">main</a> <a id="1389" class="Symbol">=</a> <a id="1391" href="Codata.IO.html#5679" class="Function">run</a> <a id="1395" href="Function.Core.html#1710" class="Function Operator">$</a> <a id="1397" class="Keyword">do</a>
  <a id="1402" class="Comment">-- the user should call e.g. @find src/ Clock.agda@</a>
  <a id="1456" class="Symbol">(</a><a id="1457" href="find.html#1457" class="Bound">fp</a> <a id="1460" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1462" href="find.html#1462" class="Bound">str</a> <a id="1466" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1468" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a><a id="1470" class="Symbol">)</a> <a id="1472" href="Codata.IO.html#1375" class="Function Operator">←</a> <a id="1474" href="System.Environment.html#371" class="Function">getArgs</a> <a id="1482" class="Keyword">where</a> <a id="1488" class="CatchallClause Symbol">_</a><a id="1489" class="CatchallClause"> </a><a id="1490" class="CatchallClause Symbol">→</a><a id="1491" class="CatchallClause"> </a><a id="1492" href="find.html#1289" class="CatchallClause Function">usage</a>
  <a id="1500" class="Keyword">let</a> <a id="1504" href="find.html#1504" class="Bound">dtree</a> <a id="1510" class="Symbol">=</a> <a id="1512" href="System.Directory.Tree.html#1595" class="Function">tree</a> <a id="1517" href="Codata.IO.html#1489" class="Function Operator">=&lt;&lt;</a> <a id="1521" href="System.Directory.html#2043" class="Function">makeAbsolute</a> <a id="1534" class="Symbol">(</a><a id="1535" href="System.FilePath.Posix.Primitive.html#2110" class="Postulate">mkFilePath</a> <a id="1546" href="find.html#1457" class="Bound">fp</a><a id="1548" class="Symbol">)</a>
  <a id="1552" href="find.html#1552" class="Bound">mfp</a> <a id="1556" href="Codata.IO.html#1375" class="Function Operator">←</a> <a id="1558" href="find.html#604" class="Function">find</a> <a id="1563" href="find.html#1462" class="Bound">str</a> <a id="1567" class="Symbol">(</a><a id="1568" href="find.html#1504" class="Bound">dtree</a> <a id="1574" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1576" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a><a id="1578" class="Symbol">)</a>
  <a id="1582" href="Function.Core.html#3716" class="Function Operator">case</a> <a id="1587" href="find.html#1552" class="Bound">mfp</a> <a id="1591" href="Function.Core.html#3716" class="Function Operator">of</a> <a id="1594" class="Symbol">λ</a> <a id="1596" class="Keyword">where</a>
    <a id="1606" href="Data.Maybe.Base.html#834" class="InductiveConstructor">nothing</a>   <a id="1616" class="Symbol">→</a> <a id="1618" href="Codata.IO.html#4715" class="Function">putStrLn</a> <a id="1627" href="Function.Core.html#1710" class="Function Operator">$</a> <a id="1629" class="String">&quot;Could not find file with name &quot;</a> <a id="1662" href="Data.String.Base.html#1744" class="Function Operator">++</a> <a id="1665" href="find.html#1462" class="Bound">str</a>
    <a id="1673" class="Symbol">(</a><a id="1674" href="Data.Maybe.Base.html#854" class="InductiveConstructor">just</a> <a id="1679" href="find.html#1679" class="Bound">fp</a><a id="1681" class="Symbol">)</a> <a id="1683" class="Symbol">→</a> <a id="1685" href="Codata.IO.html#4715" class="Function">putStrLn</a> <a id="1694" href="Function.Core.html#1710" class="Function Operator">$</a> <a id="1696" class="String">&quot;Found: &quot;</a> <a id="1706" href="Data.String.Base.html#1744" class="Function Operator">++</a> <a id="1709" href="System.FilePath.Posix.Primitive.html#1103" class="Postulate">getFilePath</a> <a id="1721" href="find.html#1679" class="Bound">fp</a>
</pre></body></html>