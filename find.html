<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>find</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="find.html" class="Module">find</a> <a id="13" class="Keyword">where</a>

<a id="20" class="Keyword">open</a> <a id="25" class="Keyword">import</a> <a id="32" href="Level.html" class="Module">Level</a>
<a id="38" class="Keyword">open</a> <a id="43" class="Keyword">import</a> <a id="50" href="Size.html" class="Module">Size</a>
<a id="55" class="Keyword">open</a> <a id="60" class="Keyword">import</a> <a id="67" href="Codata.IO.html" class="Module">Codata.IO</a>
<a id="77" class="Keyword">open</a> <a id="82" class="Keyword">import</a> <a id="89" href="Codata.Thunk.html" class="Module">Codata.Thunk</a>
<a id="102" class="Keyword">open</a> <a id="107" class="Keyword">import</a> <a id="114" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="129" class="Keyword">using</a> <a id="135" class="Symbol">(</a><a id="136" href="Data.Bool.Base.html#1312" class="Function Operator">if_then_else_</a><a id="149" class="Symbol">)</a>
<a id="151" class="Keyword">open</a> <a id="156" class="Keyword">import</a> <a id="163" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="178" class="Symbol">as</a> <a id="181" class="Module">List</a> <a id="186" class="Keyword">hiding</a> <a id="193" class="Symbol">(</a><a id="194" href="Data.List.Base.html#1570" class="Function Operator">_++_</a><a id="198" class="Symbol">)</a>
<a id="200" class="Keyword">open</a> <a id="205" class="Keyword">import</a> <a id="212" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="228" class="Keyword">using</a> <a id="234" class="Symbol">(</a><a id="235" href="Data.Maybe.Base.html#800" class="Datatype">Maybe</a><a id="240" class="Symbol">;</a> <a id="242" href="Data.Maybe.Base.html#834" class="InductiveConstructor">nothing</a><a id="249" class="Symbol">;</a> <a id="251" href="Data.Maybe.Base.html#854" class="InductiveConstructor">just</a><a id="255" class="Symbol">)</a>
<a id="257" class="Keyword">open</a> <a id="262" class="Keyword">import</a> <a id="269" href="Data.Product.html" class="Module">Data.Product</a>
<a id="282" class="Keyword">open</a> <a id="287" class="Keyword">import</a> <a id="294" href="Data.String.html" class="Module">Data.String</a>
<a id="306" class="Keyword">open</a> <a id="311" class="Keyword">import</a> <a id="318" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a>
<a id="332" class="Keyword">open</a> <a id="337" class="Keyword">import</a> <a id="344" href="Function.html" class="Module">Function</a>
<a id="353" class="Keyword">open</a> <a id="358" class="Keyword">import</a> <a id="365" href="System.Environment.html" class="Module">System.Environment</a>
<a id="384" class="Keyword">open</a> <a id="389" class="Keyword">import</a> <a id="396" href="System.FilePath.Posix.html" class="Module">System.FilePath.Posix</a>
<a id="418" class="Keyword">open</a> <a id="423" class="Keyword">import</a> <a id="430" href="System.Directory.html" class="Module">System.Directory</a>
<a id="447" class="Keyword">open</a> <a id="452" class="Keyword">import</a> <a id="459" href="System.Directory.Tree.html" class="Module">System.Directory.Tree</a>

<a id="482" class="Comment">-- @find str iots@ looks depth-first for a file with name @str@ in the</a>
<a id="553" class="Comment">-- list of subdirectories @iots@ left to process.</a>

<a id="find"></a><a id="604" href="find.html#604" class="Function">find</a> <a id="609" class="Symbol">:</a> <a id="611" href="Agda.Builtin.String.html#247" class="Postulate">String</a> <a id="618" class="Symbol">→</a> <a id="620" class="Symbol">∀</a> <a id="622" class="Symbol">{</a><a id="623" href="find.html#623" class="Bound">i</a><a id="624" class="Symbol">}</a> <a id="626" class="Symbol">→</a> <a id="628" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="633" class="Symbol">(</a><a id="634" href="Codata.IO.Core.html#278" class="Datatype">IO′</a> <a id="638" href="Level.html#512" class="Function">0ℓ</a> <a id="641" href="System.Directory.Tree.html#747" class="Function">RelativeTree</a> <a id="654" href="find.html#623" class="Bound">i</a><a id="655" class="Symbol">)</a> <a id="657" class="Symbol">→</a> <a id="659" href="Codata.IO.Core.html#278" class="Datatype">IO′</a> <a id="663" href="Level.html#512" class="Function">0ℓ</a> <a id="666" class="Symbol">(</a><a id="667" href="Data.Maybe.Base.html#800" class="Datatype">Maybe</a> <a id="673" class="Symbol">(</a><a id="674" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="679" href="System.FilePath.Posix.Primitive.html#1843" class="Function">RelativePath</a><a id="691" class="Symbol">))</a> <a id="694" href="find.html#623" class="Bound">i</a>
<a id="696" href="find.html#604" class="Function">find</a> <a id="701" href="find.html#701" class="Bound">str</a> <a id="705" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>           <a id="718" class="Symbol">=</a> <a id="720" href="Codata.IO.Core.html#549" class="Function">pure</a> <a id="725" href="Data.Maybe.Base.html#834" class="InductiveConstructor">nothing</a>
<a id="733" href="find.html#604" class="Function">find</a> <a id="738" href="find.html#738" class="Bound">str</a> <a id="742" class="Symbol">(</a><a id="743" href="find.html#743" class="Bound">iot</a> <a id="747" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="749" href="find.html#749" class="Bound">iots</a><a id="753" class="Symbol">)</a> <a id="755" class="Symbol">=</a> <a id="757" href="find.html#743" class="Bound">iot</a> <a id="761" href="Codata.IO.html#1161" class="Function Operator">&gt;&gt;=ᵗ</a> <a id="766" class="Symbol">λ</a> <a id="768" class="Keyword">where</a>
  <a id="776" class="Symbol">(</a><a id="777" href="find.html#777" class="Bound">dir</a> <a id="781" href="System.Directory.Tree.html#390" class="InductiveConstructor Operator">∋</a> <a id="783" href="find.html#783" class="Bound">fs</a> <a id="786" href="System.Directory.Tree.html#390" class="InductiveConstructor Operator">:&lt;</a> <a id="789" href="find.html#789" class="Bound">ds</a><a id="791" class="Symbol">)</a> <a id="793" class="Symbol">.</a><a id="794" href="Codata.Thunk.html#544" class="Field">force</a> <a id="800" class="Symbol">→</a> <a id="802" class="Keyword">do</a>
    <a id="809" href="Function.Core.html#3716" class="Function Operator">case</a> <a id="814" href="Data.List.Base.html#7229" class="Function">List.filter</a> <a id="826" class="Symbol">((</a><a id="828" href="find.html#738" class="Bound">str</a> <a id="832" href="Data.String.Properties.html#2571" class="Function Operator">≟_</a><a id="834" class="Symbol">)</a> <a id="836" href="Function.Core.html#1164" class="Function Operator">∘</a> <a id="838" href="System.FilePath.Posix.Primitive.html#1123" class="Postulate">getFilePath</a><a id="849" class="Symbol">)</a> <a id="851" href="find.html#783" class="Bound">fs</a> <a id="854" href="Function.Core.html#3716" class="Function Operator">of</a> <a id="857" class="Symbol">λ</a> <a id="859" class="Keyword">where</a>
      <a id="871" class="Comment">-- if we have found a suitable file in the current directory</a>
      <a id="938" class="Comment">-- then we return it immediately</a>
      <a id="977" class="Symbol">(</a><a id="978" href="find.html#978" class="Bound">fp</a> <a id="981" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="983" class="Symbol">_)</a> <a id="986" class="Symbol">→</a> <a id="988" href="Codata.IO.Core.html#549" class="Function">pure</a> <a id="993" class="Symbol">(</a><a id="994" href="Data.Maybe.Base.html#854" class="InductiveConstructor">just</a> <a id="999" class="Symbol">(</a><a id="1000" href="find.html#777" class="Bound">dir</a> <a id="1004" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1006" href="find.html#978" class="Bound">fp</a> <a id="1009" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1011" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a><a id="1013" class="Symbol">))</a>
      <a id="1022" class="Comment">-- otherwise we look for it in its subdirectories. If we fail</a>
      <a id="1090" class="Comment">-- then we look at the next directory in the list.</a>
      <a id="1147" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>       <a id="1156" class="Symbol">→</a> <a id="1158" class="Keyword">do</a>
        <a id="1169" class="Keyword">let</a> <a id="1173" href="find.html#1173" class="Bound">ds</a> <a id="1176" class="Symbol">=</a> <a id="1178" href="Data.List.Base.html#1304" class="Function">List.map</a> <a id="1187" class="Symbol">((</a><a id="1189" href="System.Directory.Tree.html#1730" class="Function">tree#</a> <a id="1195" href="Codata.IO.html#1304" class="Function Operator">&lt;$&gt;_</a><a id="1199" class="Symbol">)</a> <a id="1201" href="Function.Core.html#3365" class="Function Operator">∘′</a> <a id="1204" href="Agda.Builtin.Sigma.html#237" class="Field">proj₂</a><a id="1209" class="Symbol">)</a> <a id="1211" href="find.html#789" class="Bound">ds</a>
        <a id="1222" href="Data.Maybe.Base.html#834" class="InductiveConstructor">nothing</a> <a id="1230" href="Codata.IO.html#875" class="Function Operator">←</a> <a id="1232" href="find.html#604" class="Function">find</a> <a id="1237" href="find.html#738" class="Bound">str</a> <a id="1241" href="find.html#1173" class="Bound">ds</a> <a id="1244" class="Keyword">where</a> <a id="1250" class="Symbol">(</a><a id="1251" href="Data.Maybe.Base.html#854" class="InductiveConstructor">just</a> <a id="1256" href="find.html#1256" class="Bound">fps</a><a id="1259" class="Symbol">)</a> <a id="1261" class="Symbol">→</a> <a id="1263" href="Codata.IO.Core.html#549" class="Function">pure</a> <a id="1268" class="Symbol">(</a><a id="1269" href="Data.Maybe.Base.html#854" class="InductiveConstructor">just</a> <a id="1274" class="Symbol">(</a><a id="1275" href="find.html#777" class="Bound">dir</a> <a id="1279" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1281" href="find.html#1256" class="Bound">fps</a><a id="1284" class="Symbol">))</a>
        <a id="1295" href="find.html#604" class="Function">find</a> <a id="1300" href="find.html#738" class="Bound">str</a> <a id="1304" href="find.html#749" class="Bound">iots</a>

<a id="usage"></a><a id="1310" href="find.html#1310" class="Function">usage</a> <a id="1316" class="Symbol">:</a> <a id="1318" href="Codata.IO.Core.html#624" class="Function">IO</a> <a id="1321" href="Level.html#512" class="Function">0ℓ</a> <a id="1324" class="Symbol">_</a>
<a id="1326" href="find.html#1310" class="Function">usage</a> <a id="1332" class="Symbol">=</a> <a id="1334" href="Codata.IO.html#4948" class="Function">putStrLn</a> <a id="1343" class="String">&quot;Requires two arguments: root filepath and target file name&quot;</a>

<a id="main"></a><a id="1405" href="find.html#1405" class="Function">main</a> <a id="1410" class="Symbol">=</a> <a id="1412" href="Codata.IO.html#5912" class="Function">run</a> <a id="1416" href="Function.Core.html#1710" class="Function Operator">$</a> <a id="1418" class="Keyword">do</a>
  <a id="1423" class="Comment">-- the user should call e.g. @find src/ Clock.agda@</a>
  <a id="1477" class="Symbol">(</a><a id="1478" href="find.html#1478" class="Bound">fp</a> <a id="1481" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1483" href="find.html#1483" class="Bound">str</a> <a id="1487" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1489" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a><a id="1491" class="Symbol">)</a> <a id="1493" href="Codata.IO.html#875" class="Function Operator">←</a> <a id="1495" href="System.Environment.html#371" class="Function">getArgs</a> <a id="1503" class="Keyword">where</a> <a id="1509" class="CatchallClause Symbol">_</a><a id="1510" class="CatchallClause"> </a><a id="1511" class="CatchallClause Symbol">→</a><a id="1512" class="CatchallClause"> </a><a id="1513" href="find.html#1310" class="CatchallClause Function">usage</a>
  <a id="1521" class="Keyword">let</a> <a id="1525" href="find.html#1525" class="Bound">dtree</a> <a id="1531" class="Symbol">=</a> <a id="1533" href="System.Directory.Tree.html#1785" class="Function">tree</a> <a id="1538" href="Codata.IO.html#989" class="Function Operator">=&lt;&lt;</a> <a id="1542" href="System.Directory.html#2065" class="Function">makeAbsolute</a> <a id="1555" class="Symbol">(</a><a id="1556" href="System.FilePath.Posix.Primitive.html#2170" class="Postulate">mkFilePath</a> <a id="1567" href="find.html#1478" class="Bound">fp</a><a id="1569" class="Symbol">)</a>
  <a id="1573" href="find.html#1573" class="Bound">mfp</a> <a id="1577" href="Codata.IO.html#875" class="Function Operator">←</a> <a id="1579" href="find.html#604" class="Function">find</a> <a id="1584" href="find.html#1483" class="Bound">str</a> <a id="1588" class="Symbol">(</a><a id="1589" href="find.html#1525" class="Bound">dtree</a> <a id="1595" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1597" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a><a id="1599" class="Symbol">)</a>
  <a id="1603" href="Function.Core.html#3716" class="Function Operator">case</a> <a id="1608" href="find.html#1573" class="Bound">mfp</a> <a id="1612" href="Function.Core.html#3716" class="Function Operator">of</a> <a id="1615" class="Symbol">λ</a> <a id="1617" class="Keyword">where</a>
    <a id="1627" href="Data.Maybe.Base.html#834" class="InductiveConstructor">nothing</a>    <a id="1638" class="Symbol">→</a> <a id="1640" href="Codata.IO.html#4948" class="Function">putStrLn</a> <a id="1649" href="Function.Core.html#1710" class="Function Operator">$</a> <a id="1651" class="String">&quot;Could not find file with name &quot;</a> <a id="1684" href="Data.String.Base.html#1744" class="Function Operator">++</a> <a id="1687" href="find.html#1483" class="Bound">str</a>
    <a id="1695" class="Symbol">(</a><a id="1696" href="Data.Maybe.Base.html#854" class="InductiveConstructor">just</a> <a id="1701" href="find.html#1701" class="Bound">fps</a><a id="1704" class="Symbol">)</a> <a id="1706" class="Symbol">→</a> <a id="1708" href="Codata.IO.html#4948" class="Function">putStrLn</a> <a id="1717" href="Function.Core.html#1710" class="Function Operator">$</a> <a id="1719" class="String">&quot;Found: &quot;</a> <a id="1729" href="Data.String.Base.html#1744" class="Function Operator">++</a> <a id="1732" href="System.FilePath.Posix.Primitive.html#1123" class="Postulate">getFilePath</a> <a id="1744" class="Symbol">(</a><a id="1745" href="System.FilePath.Posix.Primitive.html#3851" class="Postulate">joinPath</a> <a id="1754" href="find.html#1701" class="Bound">fps</a><a id="1757" class="Symbol">)</a>
</pre></body></html>